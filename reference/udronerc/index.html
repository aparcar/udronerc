
<!DOCTYPE html>

<html class="no-js" lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width,initial-scale=1" name="viewport"/>
<link href="https://test.de/reference/udronerc/" rel="canonical"/>
<link href="../../assets/images/favicon.png" rel="shortcut icon"/>
<meta content="mkdocs-1.1, mkdocs-material-5.0.1" name="generator"/>
<title>Udronerc - udrone</title>
<link href="../../assets/stylesheets/main.c3000690.min.css" rel="stylesheet"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700%7CRoboto+Mono&amp;display=fallback" rel="stylesheet"/>
<style>body,input{font-family:"Roboto",-apple-system,BlinkMacSystemFont,Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono",SFMono-Regular,Consolas,Menlo,monospace}</style>
</head>
<body dir="ltr">
<input autocomplete="off" class="md-toggle" data-md-toggle="drawer" id="__drawer" type="checkbox"/>
<input autocomplete="off" class="md-toggle" data-md-toggle="search" id="__search" type="checkbox"/>
<label class="md-overlay" for="__drawer"></label>
<div data-md-component="skip">
<a class="md-skip" href="#udronerc.udronerc">
          Skip to content
        </a>
</div>
<div data-md-component="announce">
</div>
<header class="md-header" data-md-component="header">
<nav aria-label="Header" class="md-header-nav md-grid">
<a aria-label="udrone" class="md-header-nav__button md-logo" href="https://test.de" title="udrone">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z"></path></svg>
</a>
<label class="md-header-nav__button md-icon" for="__drawer">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3,6H21V8H3V6M3,11H21V13H3V11M3,16H21V18H3V16Z"></path></svg>
</label>
<div class="md-header-nav__title" data-md-component="header-title">
<div class="md-header-nav__ellipsis">
<span class="md-header-nav__topic md-ellipsis">
            udrone
          </span>
<span class="md-header-nav__topic md-ellipsis">
            
              Udronerc
            
          </span>
</div>
</div>
<label class="md-header-nav__button md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"></path></svg>
</label>
<div class="md-search" data-md-component="search" role="dialog">
<label class="md-search__overlay" for="__search"></label>
<div class="md-search__inner" role="search">
<form class="md-search__form" name="search">
<input aria-label="Search" autocapitalize="off" autocomplete="off" autocorrect="off" class="md-search__input" data-md-component="search-query" data-md-state="active" name="query" placeholder="Search" spellcheck="false" type="text"/>
<label class="md-search__icon md-icon" for="__search">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.44,13.73L14.71,14H15.5L20.5,19L19,20.5L14,15.5V14.71L13.73,14.44C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3M9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5Z"></path></svg>
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg>
</label>
<button aria-label="Clear" class="md-search__icon md-icon" data-md-component="search-reset" tabindex="-1" type="reset">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"></path></svg>
</button>
</form>
<div class="md-search__output">
<div class="md-search__scrollwrap" data-md-scrollfix="">
<div class="md-search-result" data-md-component="search-result">
<div class="md-search-result__meta">
            Type to start searching
          </div>
<ol class="md-search-result__list"></ol>
</div>
</div>
</div>
</div>
</div>
</nav>
</header>
<div class="md-container" data-md-component="container">
<main class="md-main" data-md-component="main">
<div class="md-main__inner md-grid">
<div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Navigation" class="md-nav md-nav--primary" data-md-level="0">
<label class="md-nav__title" for="__drawer">
<a aria-label="udrone" class="md-nav__button md-logo" href="https://test.de" title="udrone">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M12,8A3,3 0 0,0 15,5A3,3 0 0,0 12,2A3,3 0 0,0 9,5A3,3 0 0,0 12,8M12,11.54C9.64,9.35 6.5,8 3,8V19C6.5,19 9.64,20.35 12,22.54C14.36,20.35 17.5,19 21,19V8C17.5,8 14.36,9.35 12,11.54Z"></path></svg>
</a>
    udrone
  </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../.." title="udrone - QA done right">
      udrone - QA done right
    </a>
</li>
<li class="md-nav__item md-nav__item--nested">
<input class="md-nav__toggle md-toggle" data-md-toggle="nav-2" id="nav-2" type="checkbox"/>
<label class="md-nav__link" for="nav-2">
      Development
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"></path></svg>
</span>
</label>
<nav aria-label="Development" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-2">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg>
</span>
        Development
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../../development/setup/" title="Test setup">
      Test setup
    </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item md-nav__item--active md-nav__item--nested">
<input checked="" class="md-nav__toggle md-toggle" data-md-toggle="nav-3" id="nav-3" type="checkbox"/>
<label class="md-nav__link" for="nav-3">
      Reference
      <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M8.59,16.58L13.17,12L8.59,7.41L10,6L16,12L10,18L8.59,16.58Z"></path></svg>
</span>
</label>
<nav aria-label="Reference" class="md-nav" data-md-level="1">
<label class="md-nav__title" for="nav-3">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg>
</span>
        Reference
      </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="../qa/" title="Qa">
      Qa
    </a>
</li>
<li class="md-nav__item md-nav__item--active">
<input class="md-nav__toggle md-toggle" data-md-toggle="toc" id="__toc" type="checkbox"/>
<label class="md-nav__link md-nav__link--active" for="__toc">
        Udronerc
        <span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M3,9H17V7H3V9M3,13H17V11H3V13M3,17H17V15H3V17M19,17H21V15H19V17M19,7V9H21V7H19M19,13H21V11H19V13Z"></path></svg>
</span>
</label>
<a class="md-nav__link md-nav__link--active" href="./" title="Udronerc">
      Udronerc
    </a>
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc">
    udronerc.udronerc
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneGroup">
    DroneGroup
  </a>
<nav aria-label="DroneGroup" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneGroup.assign">
    assign()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneGroup.engage">
    engage()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost">
    DroneHost
  </a>
<nav aria-label="DroneHost" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.call">
    call()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.call_multi">
    call_multi()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.genseq">
    genseq()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.get_ip_address">
    get_ip_address()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.Group">
    Group()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.recv">
    recv()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.recv_until">
    recv_until()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.send">
    send()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.whois">
    whois()
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
<div class="md-sidebar__scrollwrap">
<div class="md-sidebar__inner">
<nav aria-label="Table of contents" class="md-nav md-nav--secondary">
<label class="md-nav__title" for="__toc">
<span class="md-nav__icon md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg>
</span>
      Table of contents
    </label>
<ul class="md-nav__list" data-md-scrollfix="">
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc">
    udronerc.udronerc
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneGroup">
    DroneGroup
  </a>
<nav aria-label="DroneGroup" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneGroup.assign">
    assign()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneGroup.engage">
    engage()
  </a>
</li>
</ul>
</nav>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost">
    DroneHost
  </a>
<nav aria-label="DroneHost" class="md-nav">
<ul class="md-nav__list">
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.call">
    call()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.call_multi">
    call_multi()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.genseq">
    genseq()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.get_ip_address">
    get_ip_address()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.Group">
    Group()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.recv">
    recv()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.recv_until">
    recv_until()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.send">
    send()
  </a>
</li>
<li class="md-nav__item">
<a class="md-nav__link" href="#udronerc.udronerc.DroneHost.whois">
    whois()
  </a>
</li>
</ul>
</nav>
</li>
</ul>
</nav>
</div>
</div>
</div>
<div class="md-content">
<article class="md-content__inner md-typeset">
<h1>Udronerc</h1>
<div class="doc doc-object doc-module">
<h2 class="hidden-toc" href="#udronerc.udronerc" id="udronerc.udronerc" style="visibility: hidden; width: 0; height: 0;">
</h2>
<div class="doc doc-contents first">
<div class="doc doc-children">
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="udronerc.udronerc.DroneGroup">
<code>DroneGroup</code>
</h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="udronerc.udronerc.DroneGroup.assign">
<code class="highlight language-python">
assign<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_nodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">min_nodes</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">board</span><span class="o">=</span><span class="s1">'generic'</span><span class="p">)</span> </code>
</h3>
<div class="doc doc-contents">
<p>Assign nodes to group</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>max_nodes</code></td>
<td><code>int</code></td>
<td>
<p>maximal number of nodes required</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>min_nodes</code></td>
<td><code>int</code></td>
<td>
<p>mimimal number of nodes required</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>board</code></td>
<td><code>str</code></td>
<td>
<p>limit assignment to specific board</p>
</td>
<td><code>'generic'</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>list</code></td>
<td>
<p>list: new member os group</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>udronerc/udronerc.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span> 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111
112
113
114</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code>    <span class="k">def</span> <span class="nf">assign</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">max_nodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">min_nodes</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">board</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">"generic"</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
        <span class="sd">"""</span>
<span class="sd">        Assign nodes to group</span>

<span class="sd">        Args:</span>
<span class="sd">            max_nodes (int): maximal number of nodes required</span>
<span class="sd">            min_nodes (int): mimimal number of nodes required</span>
<span class="sd">            board (str): limit assignment to specific board</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: new member os group</span>
<span class="sd">        """</span>

<span class="c1">#        ingroup = self.host.whois(self.groupid, max_nodes, board=board)</span>
<span class="c1">#        print(ingroup)</span>

<span class="c1">#        if max_nodes &gt;= len(ingroup) &gt;= min_nodes:</span>
<span class="c1">#            return list(ingroup.keys())</span>

        <span class="n">available</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">whois</span><span class="p">(</span><span class="n">UDRONE_GROUP_DEFAULT</span><span class="p">,</span> <span class="n">max_nodes</span><span class="p">,</span> <span class="n">board</span><span class="o">=</span><span class="n">board</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span>
                <span class="p">:</span><span class="n">max_nodes</span>
            <span class="p">]</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">available</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_nodes</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">DroneNotFoundError</span><span class="p">((</span><span class="n">ENOENT</span><span class="p">,</span> <span class="s2">"You must construct additional drones"</span><span class="p">))</span>

        <span class="n">new_members</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">engage</span><span class="p">(</span><span class="n">available</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_members</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_nodes</span><span class="p">:</span>
            <span class="n">max_nodes</span> <span class="o">-=</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_members</span><span class="p">)</span>
            <span class="n">available</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">whois</span><span class="p">(</span><span class="n">UDRONE_GROUP_DEFAULT</span><span class="p">,</span> <span class="n">max_nodes</span><span class="p">)</span><span class="o">.</span><span class="n">keys</span><span class="p">())[</span>
                <span class="p">:</span><span class="n">max_nodes</span>
            <span class="p">]</span>
            <span class="n">new_members</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">engage</span><span class="p">(</span><span class="n">available</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_members</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">min_nodes</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">new_members</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>  <span class="c1"># Rollback</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">call_multi</span><span class="p">(</span><span class="n">new_members</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">"!reset"</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">"status"</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">DroneNotFoundError</span><span class="p">((</span><span class="n">ENOENT</span><span class="p">,</span> <span class="s2">"You must construct additional drones"</span><span class="p">))</span>

        <span class="k">return</span> <span class="n">new_members</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="udronerc.udronerc.DroneGroup.engage">
<code class="highlight language-python">
engage<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">)</span> </code>
</h3>
<div class="doc doc-contents">
<p>Invite nodes by ID</p>
<details class="quote">
<summary>Source code in <code>udronerc/udronerc.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>116
117
118
119
120
121
122
123
124
125
126
127
128</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">engage</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">):</span>
    <span class="sd">"""Invite nodes by ID</span>

<span class="sd">    """</span>
    <span class="n">ans</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">host</span><span class="o">.</span><span class="n">call_multi</span><span class="p">(</span><span class="n">nodes</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="s2">"!assign"</span><span class="p">,</span> <span class="p">{</span><span class="s2">"group"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">groupid</span><span class="p">,</span> <span class="s2">"seq"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">seq</span><span class="p">},</span> <span class="s2">"status"</span><span class="p">)</span>
    <span class="n">members</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">member</span><span class="p">,</span> <span class="n">answer</span> <span class="ow">in</span> <span class="n">ans</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">member</span><span class="p">,</span> <span class="n">answer</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">answer</span><span class="p">[</span><span class="s2">"data"</span><span class="p">][</span><span class="s2">"code"</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">members</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">member</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">members</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">members</span> <span class="o">|=</span> <span class="nb">set</span><span class="p">(</span><span class="n">members</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">members</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
<div class="doc doc-object doc-class">
<h2 class="doc doc-heading" id="udronerc.udronerc.DroneHost">
<code>DroneHost</code>
</h2>
<div class="doc doc-contents">
<div class="doc doc-children">
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="udronerc.udronerc.DroneHost.call">
<code class="highlight language-python">
call<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">msg_type</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resp_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">expect</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
</h3>
<div class="doc doc-contents">
<p>Send data to drone and receive response</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>to</code></td>
<td><code>str</code></td>
<td>
<p>selected group</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>seq</code></td>
<td><code>int</code></td>
<td>
<p>sequence number</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>msg_type</code></td>
<td><code>str</code></td>
<td>
<p>send message of type</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>data</code></td>
<td><code>dict</code></td>
<td>
<p>data to send to group</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>resp_type</code></td>
<td><code>str</code></td>
<td>
<p>receive message of type</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>expect</code></td>
<td><code>list</code></td>
<td>
<p>list of drones expected to anser</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dict</code></td>
<td>
<p>dict: received message from drones</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>udronerc/udronerc.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">call</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">to</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">seq</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">msg_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">resp_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">expect</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Send data to drone and receive response</span>

<span class="sd">    Args:</span>
<span class="sd">        to (str): selected group</span>
<span class="sd">        seq (int): sequence number</span>
<span class="sd">        msg_type (str): send message of type</span>
<span class="sd">        data (dict): data to send to group</span>
<span class="sd">        resp_type (str): receive message of type</span>
<span class="sd">        expect (list): list of drones expected to anser</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: received message from drones</span>
<span class="sd">    """</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">seq</span><span class="p">:</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genseq</span><span class="p">()</span>

    <span class="n">answers</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">timeout</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">resent_strategy</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">to</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">msg_type</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recv_until</span><span class="p">(</span><span class="n">answers</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">resp_type</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">expect</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">expect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">expect</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">answers</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="udronerc.udronerc.DroneHost.call_multi">
<code class="highlight language-python">
call_multi<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nodes</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">msg_type</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">resp_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
</h3>
<div class="doc doc-contents">
<p>Send data to multiple drones and receive responses</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>nodes</code></td>
<td><code>list</code></td>
<td>
<p>selected drones</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>seq</code></td>
<td><code>int</code></td>
<td>
<p>sequence number</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>msg_type</code></td>
<td><code>str</code></td>
<td>
<p>send message of type</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>data</code></td>
<td><code>dict</code></td>
<td>
<p>data to send to group</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>resp_type</code></td>
<td><code>str</code></td>
<td>
<p>receive message of type</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dict</code></td>
<td>
<p>dict: received message from drones</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>udronerc/udronerc.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">call_multi</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">nodes</span><span class="p">:</span> <span class="nb">list</span><span class="p">,</span>
    <span class="n">seq</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">msg_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">resp_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Send data to multiple drones and receive responses</span>

<span class="sd">    Args:</span>
<span class="sd">        nodes (list): selected drones</span>
<span class="sd">        seq (int): sequence number</span>
<span class="sd">        msg_type (str): send message of type</span>
<span class="sd">        data (dict): data to send to group</span>
<span class="sd">        resp_type (str): receive message of type</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: received message from drones</span>
<span class="sd">    """</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">seq</span><span class="p">:</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genseq</span><span class="p">()</span>

    <span class="n">answers</span> <span class="o">=</span> <span class="p">{}</span>

    <span class="k">for</span> <span class="n">timeout</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">resent_strategy</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">node</span> <span class="ow">in</span> <span class="n">nodes</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">node</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">msg_type</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recv_until</span><span class="p">(</span><span class="n">answers</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">resp_type</span><span class="p">,</span> <span class="n">timeout</span><span class="p">,</span> <span class="n">nodes</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nodes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
    <span class="k">return</span> <span class="n">answers</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="udronerc.udronerc.DroneHost.genseq">
<code class="highlight language-python">
genseq<span class="p">(</span><span class="bp">self</span><span class="p">)</span> </code>
</h3>
<div class="doc doc-contents">
<p>Generate random sequence number</p>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>int</code></td>
<td>
<p>int: generated sequence</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>udronerc/udronerc.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>255
256
257
258
259
260
261
262</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">genseq</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">int</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Generate random sequence number</span>

<span class="sd">    Returns:</span>
<span class="sd">        int: generated sequence</span>
<span class="sd">    """</span>
    <span class="k">return</span> <span class="n">struct</span><span class="o">.</span><span class="n">unpack</span><span class="p">(</span><span class="s2">"=I"</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">urandom</span><span class="p">(</span><span class="mi">4</span><span class="p">))[</span><span class="mi">0</span><span class="p">]</span> <span class="o">%</span> <span class="mi">2000000000</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="udronerc.udronerc.DroneHost.get_ip_address">
<code class="highlight language-python">
get_ip_address<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="p">)</span> </code>
</h3>
<div class="doc doc-contents">
<p>Get IP of a local interface</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>interface</code></td>
<td><code>str</code></td>
<td>
<p>name of local interface</p>
</td>
<td><em>required</em></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>str</code></td>
<td>
<p>str: IP address of interface</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>udronerc/udronerc.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">get_ip_address</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">interface</span><span class="p">:</span> <span class="nb">str</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">str</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Get IP of a local interface</span>

<span class="sd">    Args:</span>
<span class="sd">        interface (str): name of local interface</span>

<span class="sd">    Returns:</span>
<span class="sd">        str: IP address of interface</span>
<span class="sd">    """</span>
    <span class="n">s</span> <span class="o">=</span> <span class="n">socket</span><span class="o">.</span><span class="n">socket</span><span class="p">(</span><span class="n">socket</span><span class="o">.</span><span class="n">AF_INET</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">SOCK_DGRAM</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">socket</span><span class="o">.</span><span class="n">inet_ntoa</span><span class="p">(</span>
        <span class="n">fcntl</span><span class="o">.</span><span class="n">ioctl</span><span class="p">(</span>
            <span class="n">s</span><span class="o">.</span><span class="n">fileno</span><span class="p">(),</span>
            <span class="mh">0x8915</span><span class="p">,</span>
            <span class="n">struct</span><span class="o">.</span><span class="n">pack</span><span class="p">(</span><span class="s2">"256s"</span><span class="p">,</span> <span class="n">interface</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">"utf-8"</span><span class="p">)),</span>  <span class="c1"># SIOCGIFADDR</span>
        <span class="p">)[</span><span class="mi">20</span><span class="p">:</span><span class="mi">24</span><span class="p">]</span>
    <span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="udronerc.udronerc.DroneHost.Group">
<code class="highlight language-python">
Group<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groupid</span><span class="p">,</span> <span class="n">absolute</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span> </code>
</h3>
<div class="doc doc-contents">
<p>Create new group</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>groupid</code></td>
<td><code>str</code></td>
<td>
<p>Name of the new group</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>absolute</code></td>
<td><code>bool</code></td>
<td>
<p>Prefix group name with hostid</p>
</td>
<td><code>False</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>Group</code></td>
<td>
<p>Newly created group</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>udronerc/udronerc.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">Group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groupid</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">absolute</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>
    <span class="sd">"""Create new group</span>

<span class="sd">    Args:</span>
<span class="sd">        groupid (str): Name of the new group</span>
<span class="sd">        absolute (bool): Prefix group name with hostid</span>

<span class="sd">    Returns:</span>
<span class="sd">        Group: Newly created group</span>
<span class="sd">    """</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">absolute</span><span class="p">:</span>
        <span class="n">groupid</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">"</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">hostid</span><span class="si">}</span><span class="s2">_</span><span class="si">{</span><span class="n">groupid</span><span class="si">}</span><span class="s2">"</span>

    <span class="n">group</span> <span class="o">=</span> <span class="n">DroneGroup</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">groupid</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">groups</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">group</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">group</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="udronerc.udronerc.DroneHost.recv">
<code class="highlight language-python">
recv<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">msg_type</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
</h3>
<div class="doc doc-contents">
<p>Recevie messages from drones</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>seq</code></td>
<td><code>int</code></td>
<td>
<p>sequence number</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>msg_type</code></td>
<td><code>str</code></td>
<td>
<p>type of message to receive</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dict</code></td>
<td>
<p>dict: received message from drone</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>udronerc/udronerc.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">recv</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">seq</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">msg_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Recevie messages from drones</span>

<span class="sd">    Args:</span>
<span class="sd">        seq (int): sequence number</span>
<span class="sd">        msg_type (str): type of message to receive</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: received message from drone</span>
<span class="sd">    """</span>
    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maxsize</span><span class="p">))</span>
            <span class="k">if</span> <span class="p">(</span>
                <span class="n">msg</span><span class="p">[</span><span class="s2">"from"</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">msg</span><span class="p">[</span><span class="s2">"type"</span><span class="p">]</span>
                <span class="ow">and</span> <span class="n">msg</span><span class="p">[</span><span class="s2">"to"</span><span class="p">]</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">hostid</span>
                <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">msg_type</span> <span class="ow">or</span> <span class="n">msg</span><span class="p">[</span><span class="s2">"type"</span><span class="p">]</span> <span class="o">==</span> <span class="n">msg_type</span><span class="p">)</span>
                <span class="ow">and</span> <span class="p">(</span><span class="ow">not</span> <span class="n">seq</span> <span class="ow">or</span> <span class="n">msg</span><span class="p">[</span><span class="s2">"seq"</span><span class="p">]</span> <span class="o">==</span> <span class="n">seq</span><span class="p">)</span>
            <span class="p">):</span>
                <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">"Received: </span><span class="si">%s</span><span class="s2">"</span><span class="p">,</span> <span class="nb">str</span><span class="p">(</span><span class="n">msg</span><span class="p">))</span>
                <span class="k">return</span> <span class="n">msg</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">e</span><span class="p">,</span> <span class="n">socket</span><span class="o">.</span><span class="n">error</span><span class="p">)</span> <span class="ow">and</span> <span class="n">e</span><span class="o">.</span><span class="n">errno</span> <span class="o">==</span> <span class="n">EWOULDBLOCK</span><span class="p">:</span>
                <span class="k">return</span> <span class="kc">None</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="udronerc.udronerc.DroneHost.recv_until">
<code class="highlight language-python">
recv_until<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">answers</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">msg_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">expect</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
</h3>
<div class="doc doc-contents">
<p>Recevie messages from drones until requirement is fulfilled</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>answers</code></td>
<td><code>dict</code></td>
<td>
<p>Empty dict to be filled with received answers</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>seq</code></td>
<td><code>int</code></td>
<td>
<p>sequence number</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>msg_type</code></td>
<td><code>str</code></td>
<td>
<p>type of message to receive</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>timeout</code></td>
<td><code>int</code></td>
<td>
<p>number of seconds before receiving timeouts</p>
</td>
<td><code>1</code></td>
</tr>
<tr>
<td><code>expect</code></td>
<td><code>list</code></td>
<td>
<p>list of drones expected to anser</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>udronerc/udronerc.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">recv_until</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">answers</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span>
    <span class="n">seq</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
    <span class="n">msg_type</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">timeout</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">expect</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">):</span>
    <span class="sd">"""</span>
<span class="sd">    Recevie messages from drones until requirement is fulfilled</span>

<span class="sd">    Args:</span>
<span class="sd">        answers (dict): Empty dict to be filled with received answers</span>
<span class="sd">        seq (int): sequence number</span>
<span class="sd">        msg_type (str): type of message to receive</span>
<span class="sd">        timeout (int): number of seconds before receiving timeouts</span>
<span class="sd">        expect (list): list of drones expected to anser</span>
<span class="sd">    """</span>

    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span>
        <span class="s2">"Receiving replies for seq </span><span class="si">%i</span><span class="s2"> for </span><span class="si">%.1f</span><span class="s2"> secs expecting </span><span class="si">%s</span><span class="s2">"</span><span class="p">,</span>
        <span class="n">seq</span><span class="p">,</span>
        <span class="n">timeout</span><span class="p">,</span>
        <span class="n">expect</span><span class="p">,</span>
    <span class="p">)</span>
    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">now</span> <span class="o">=</span> <span class="n">start</span>
    <span class="k">while</span> <span class="p">(</span>
        <span class="p">(</span><span class="n">now</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">now</span> <span class="o">-</span> <span class="n">start</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">timeout</span>
        <span class="ow">and</span> <span class="p">(</span><span class="n">expect</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">expect</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">)</span>
    <span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">poll</span><span class="o">.</span><span class="n">poll</span><span class="p">((</span><span class="n">timeout</span> <span class="o">-</span> <span class="p">(</span><span class="n">now</span> <span class="o">-</span> <span class="n">start</span><span class="p">))</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">)</span>
        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">recv</span><span class="p">(</span><span class="n">seq</span><span class="p">,</span> <span class="n">msg_type</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">msg</span><span class="p">:</span>
                <span class="n">answers</span><span class="p">[</span><span class="n">msg</span><span class="p">[</span><span class="s2">"from"</span><span class="p">]]</span> <span class="o">=</span> <span class="n">msg</span>
                <span class="k">if</span> <span class="n">expect</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">msg</span><span class="p">[</span><span class="s2">"from"</span><span class="p">]</span> <span class="ow">in</span> <span class="n">expect</span><span class="p">:</span>
                    <span class="n">expect</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">msg</span><span class="p">[</span><span class="s2">"from"</span><span class="p">])</span>
            <span class="k">elif</span> <span class="ow">not</span> <span class="n">msg</span><span class="p">:</span>
                <span class="k">break</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="udronerc.udronerc.DroneHost.send">
<code class="highlight language-python">
send<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="n">msg_type</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{})</span> </code>
</h3>
<div class="doc doc-contents">
<p>Send message to drone</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>to</code></td>
<td><code>str</code></td>
<td>
<p>receiving group</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>seq</code></td>
<td><code>int</code></td>
<td>
<p>sequence number</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>msg_type</code></td>
<td><code>str</code></td>
<td>
<p>type of message to receive</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>data</code></td>
<td><code>dict</code></td>
<td>
<p>data to send to node</p>
</td>
<td><code>{}</code></td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>udronerc/udronerc.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>264
265
266
267
268
269
270
271
272
273
274
275
276
277</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">send</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">to</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">seq</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">msg_type</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="p">{}):</span>
    <span class="sd">"""</span>
<span class="sd">    Send message to drone</span>

<span class="sd">    Args:</span>
<span class="sd">        to (str): receiving group</span>
<span class="sd">        seq (int): sequence number</span>
<span class="sd">        msg_type (str): type of message to receive</span>
<span class="sd">        data (dict): data to send to node</span>
<span class="sd">    """</span>
    <span class="n">msg</span> <span class="o">=</span> <span class="p">{</span><span class="s2">"from"</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">hostid</span><span class="p">,</span> <span class="s2">"to"</span><span class="p">:</span> <span class="n">to</span><span class="p">,</span> <span class="s2">"type"</span><span class="p">:</span> <span class="n">msg_type</span><span class="p">,</span> <span class="s2">"seq"</span><span class="p">:</span> <span class="n">seq</span><span class="p">,</span> <span class="s2">"data"</span><span class="p">:</span> <span class="n">data</span><span class="p">}</span>
    <span class="n">packet</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">msg</span><span class="p">,</span> <span class="n">separators</span><span class="o">=</span><span class="p">(</span><span class="s2">","</span><span class="p">,</span> <span class="s2">":"</span><span class="p">))</span>
    <span class="n">logger</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="sa">f</span><span class="s2">"Sending: </span><span class="si">{</span><span class="n">packet</span><span class="si">}</span><span class="s2">"</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">socket</span><span class="o">.</span><span class="n">sendto</span><span class="p">(</span><span class="n">packet</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">"utf-8"</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">addr</span><span class="p">)</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
<div class="doc doc-object doc-method">
<h3 class="doc doc-heading" id="udronerc.udronerc.DroneHost.whois">
<code class="highlight language-python">
whois<span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">,</span> <span class="n">need</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">seq</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">board</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> </code>
</h3>
<div class="doc doc-contents">
<p>Return online drones</p>
<p><strong>Parameters:</strong></p>
<table>
<thead>
<tr>
<th>Name</th>
<th>Type</th>
<th>Description</th>
<th>Default</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>group</code></td>
<td><code>str</code></td>
<td>
<p>limit request to specific group</p>
</td>
<td><em>required</em></td>
</tr>
<tr>
<td><code>need</code></td>
<td><code>int</code></td>
<td>
<p>minimum number of ansers</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>seq</code></td>
<td><code>int</code></td>
<td>
<p>sequence number</p>
</td>
<td><code>None</code></td>
</tr>
<tr>
<td><code>board</code></td>
<td><code>str</code></td>
<td>
<p>limit request to specific board</p>
</td>
<td><code>None</code></td>
</tr>
</tbody>
</table>
<p><strong>Returns:</strong></p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>dict</code></td>
<td>
<p>dict: received answers of boards</p>
</td>
</tr>
</tbody>
</table>
<details class="quote">
<summary>Source code in <code>udronerc/udronerc.py</code></summary>
<table class="highlighttable">
<tr>
<td class="linenos">
<div class="linenodiv">
<pre><span></span>420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450</pre>
</div>
</td>
<td class="code">
<div class="highlight">
<pre><span></span><code><span class="k">def</span> <span class="nf">whois</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">group</span><span class="p">:</span> <span class="nb">str</span><span class="p">,</span> <span class="n">need</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">seq</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">board</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="sd">"""</span>
<span class="sd">    Return online drones</span>

<span class="sd">    Args:</span>
<span class="sd">        group (str): limit request to specific group</span>
<span class="sd">        need (int): minimum number of ansers</span>
<span class="sd">        seq (int): sequence number</span>
<span class="sd">        board (str): limit request to specific board</span>

<span class="sd">    Returns:</span>
<span class="sd">        dict: received answers of boards</span>
<span class="sd">    """</span>
    <span class="n">answers</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">if</span> <span class="n">seq</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">seq</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">genseq</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">timeout</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">resent_strategy</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">board</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="s2">"board"</span><span class="p">]</span> <span class="o">=</span> <span class="n">board</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">send</span><span class="p">(</span><span class="n">group</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="s2">"!whois"</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">need</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">break</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recv_until</span><span class="p">(</span><span class="n">answers</span><span class="p">,</span> <span class="n">seq</span><span class="p">,</span> <span class="s2">"status"</span><span class="p">,</span> <span class="n">timeout</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">need</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">answers</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="n">need</span><span class="p">:</span>
            <span class="k">break</span>

    <span class="k">return</span> <span class="n">answers</span>
</code></pre>
</div>
</td>
</tr>
</table>
</details>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</article>
</div>
</div>
</main>
<footer class="md-footer">
<div class="md-footer-nav">
<nav aria-label="Footer" class="md-footer-nav__inner md-grid">
<a class="md-footer-nav__link md-footer-nav__link--prev" href="../qa/" rel="prev" title="Qa">
<div class="md-footer-nav__button md-icon">
<svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path d="M20,11V13H8L13.5,18.5L12.08,19.92L4.16,12L12.08,4.08L13.5,5.5L8,11H20Z"></path></svg>
</div>
<div class="md-footer-nav__title">
<div class="md-ellipsis">
<span class="md-footer-nav__direction">
                  Previous
                </span>
                Qa
              </div>
</div>
</a>
</nav>
</div>
<div class="md-footer-meta md-typeset">
<div class="md-footer-meta__inner md-grid">
<div class="md-footer-copyright">
        
        Made with
        <a href="https://squidfunk.github.io/mkdocs-material/" rel="noopener" target="_blank">
          Material for MkDocs
        </a>
</div>
</div>
</div>
</footer>
</div>
<script src="../../assets/javascripts/vendor.f45d2d8d.min.js"></script>
<script src="../../assets/javascripts/bundle.74d0b805.min.js"></script><script id="__lang" type="application/json">{"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents"}</script>
<script>
        app = initialize({
          base: "../..",
          features: [],
          search: Object.assign({
            worker: "../../assets/javascripts/worker/search.7f7c8775.min.js"
          }, typeof search !== "undefined" && search)
        })
      </script>
</body>
</html>